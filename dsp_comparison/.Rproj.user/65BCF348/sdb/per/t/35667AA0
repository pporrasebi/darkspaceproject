{
    "contents" : "---\ntitle: Comparison of IMEx with other protein association datasets\ndate: 2016-04-12\nauthor: Pablo Porras\n---\n```{r set-options, echo=FALSE}\noptions(width = 80)\n```\nEstimating the size of the uncurated interactome\n========================================================\n\n### Synopsis\n\nAfter producing tidy datasets comparing different resources to IMEx data, we put together the data and compare the overlap. \n\n### Part 1: Load datasets\n\n#### IMEx dataset\n\nI select only purely human interactions here (interactions where both proteins are human). \n\n```{r warning=FALSE,message=FALSE, eval=FALSE}\nsystem(\"Rscript ./scripts/IMEx_ds_generator.R --save\")\n```\n```{r warning=FALSE,message=FALSE}\nimex_full <- read.delim(\"../IMEx/results/imex_full.txt\", header=T, sep=\"\\t\",colClasses=\"character\")\nimex_human <- unique(subset(imex_full,taxid_a==\"9606\" & taxid_b==\"9606\"))\nlibrary(dplyr)\nimex_human$imex <- 1\nimex_human_sel <- unique(select(imex_human,pair_id=pair_id_clean,pmid=pubid,imex))\nimex_pairs <- unique(select(imex_human,pair_id=pair_id_clean,imex))\nimex_pmids <- unique(select(imex_human,pmid=pubid,imex))\n```\n\nThe dataset contains `r nrow(imex_pairs)` protein interactions recorded in `r nrow(imex_pmids)` publications.\n\n#### Reactome data\n\n```{r}\nreactome_pairs_pmids <- read.csv(gzfile(\"../reactome_interactions/results/pairs_pmid_reactome.txt.gz\"),header=T,sep=\"\\t\",colClasses=c(\"character\",\"character\",\"numeric\"))\nreactome_pairs <- unique(select(reactome_pairs_pmids,pair_id,reactome))\nreactome_pmids <- unique(select(reactome_pairs_pmids,pmid,reactome))\n```\n\nThe reactome dataset contains `r nrow(reactome_pairs)` protein associations recorded in `r nrow(reactome_pmids)` publications. \n\n#### Text-mining EPMC data\n\n```{r}\ntm_pairs_pmids <- read.csv(gzfile(\"../epmc_text_mining/results/pairs_pmids_tm.txt.gz\"),header=T,sep=\"\\t\",colClasses=c(\"character\",\"character\",\"numeric\",\"numeric\",\"numeric\",\"numeric\"))\ntm_pairs_pmids_sel <- unique(select(tm_pairs_pmids,pair_id,pmid,tm_epmc=tm))\ntm_pairs <- unique(select(tm_pairs_pmids,pair_id,tm_epmc=tm))\ntm_pmids <- unique(select(tm_pairs_pmids,pmid,tm_epmc=tm))\n```\n\nThe text-mining EPMC dataset contains `r nrow(tm_pairs)` protein associations recorded in `r nrow(tm_pmids)` publications.\n\n#### IID predictions data\n\n```{r}\niid_pred_pairs <- read.csv(\"../iid_predictions/results/pairs_iid_pred.txt\",header=T,sep=\"\\t\",colClasses=c(\"character\",\"numeric\"))\n```\n\nThe IID-predictions dataset contains `r nrow(iid_pred_pairs)` protein associations.\n\n### Part 2: Generating comparison dataset at the pair level\n\n```{r}\nall_df <- list(imex_pairs,reactome_pairs,tm_pairs,iid_pred_pairs)\n\ncomp_table <- Reduce(function(...) merge(..., all=TRUE), all_df)\n\n# I clean and replace all NAs if present.\n\ncomp_table_final <- comp_table\ncomp_table_final[is.na(comp_table_final <- comp_table)] <- 0\nwrite.table(comp_table_final,\"./results/comp_table_final.txt\",col.names=T,row.names=F,sep=\"\\t\",quote=F)\nsystem(\"gzip ./results/comp_table_final.txt\")\n```\n\nThe comparison set gives a total number of `r nrow(comp_table_final)` potentially interacting pairs, of which `r nrow(comp_table_final[comp_table_final$imex==0,])` (`r round(nrow(comp_table_final[comp_table_final$imex==0,])*100/nrow(comp_table_final),2)`%) are not curated in IMEx. \n\nI produce a plot with the summary of the overlap between the different datasets evaluated. \n\n##### Figure 1: Comparison between different protein association datasets\n```{r echo=FALSE, fig.width=10,fig.height=6}\nlibrary(UpSetR)\nupset(comp_table_final, \n      nsets = 4, \n      point.size = 6, \n      name.size = 12, \n      line.size = 2, \n      mainbar.y.label = \"Common protein pairs\", \n      sets.x.label = \"Nr of protein pairs in dataset\", \n      order.by=\"freq\",\n      decreasing=FALSE,\n      queries = list(\n              list(query = intersects, params = list(\"reactome\",\"iid_pred\",\"tm_epmc\"), color = \"blue\", active = T),\n              list(query = intersects, params = list(\"iid_pred\",\"tm_epmc\"), color= \"cornflowerblue\",active = T),\n              list(query = intersects, params = list(\"reactome\",\"iid_pred\"), color= \"cornflowerblue\",active = T),\n              list(query = intersects, params = list(\"reactome\",\"tm_epmc\"), color= \"cornflowerblue\",active = T),\n              list(query = intersects, params = list(\"imex\",\"iid_pred\",\"reactome\",\"tm_epmc\"), color= \"darkorange2\",active = T),\n              list(query = intersects, params = list(\"imex\",\"reactome\",\"tm_epmc\"), color= \"orange1\",active = T),\n              list(query = intersects, params = list(\"imex\",\"iid_pred\",\"tm_epmc\"), color= \"orange1\",active = T),\n              list(query = intersects, params = list(\"imex\",\"iid_pred\",\"reactome\"), color= \"orange1\",active = T),\n              list(query = intersects, params = list(\"imex\",\"iid_pred\"), color= \"lightgoldenrod2\",active = T),\n              list(query = intersects, params = list(\"imex\",\"reactome\"), color= \"lightgoldenrod2\",active = T),\n              list(query = intersects, params = list(\"imex\",\"tm_epmc\"), color= \"lightgoldenrod2\",active = T),\n              list(query = intersects, params = list(\"imex\"), color= \"gray70\",active = T),\n              list(query = intersects, params = list(\"reactome\"), color= \"gray70\",active = T),\n              list(query = intersects, params = list(\"iid_pred\"), color= \"gray70\",active = T),\n              list(query = intersects, params = list(\"tm_epmc\"), color= \"gray70\",active = T)))\n\n```\n\nI also produce a sub-plot showing exclusively the intersections, so a more informative scale is used. \n\n##### Figure 2: Intersection between different protein association datasets\n```{r echo=FALSE,fig.width=10,fig.height=6}\nupset(comp_table_final, \n      nsets = 4, \n      point.size = 6, \n      name.size = 12, \n      line.size = 2, \n      mainbar.y.label = \"Common protein pairs\", \n      sets.x.label = \"Nr of protein pairs in dataset\",\n      order.by=\"freq\",\n      decreasing=FALSE,\n      queries = list(\n              list(query = intersects, params = list(\"reactome\",\"iid_pred\",\"tm_epmc\"), color = \"blue\", active = T),\n              list(query = intersects, params = list(\"iid_pred\",\"tm_epmc\"), color= \"cornflowerblue\",active = T),\n              list(query = intersects, params = list(\"reactome\",\"iid_pred\"), color= \"cornflowerblue\",active = T),\n              list(query = intersects, params = list(\"reactome\",\"tm_epmc\"), color= \"cornflowerblue\",active = T),\n              list(query = intersects, params = list(\"imex\",\"iid_pred\",\"reactome\",\"tm_epmc\"), color= \"darkorange2\",active = T),\n              list(query = intersects, params = list(\"imex\",\"reactome\",\"tm_epmc\"), color= \"orange1\",active = T),\n              list(query = intersects, params = list(\"imex\",\"iid_pred\",\"tm_epmc\"), color= \"orange1\",active = T),\n              list(query = intersects, params = list(\"imex\",\"iid_pred\",\"reactome\"), color= \"orange1\",active = T),\n              list(query = intersects, params = list(\"imex\",\"iid_pred\"), color= \"lightgoldenrod2\",active = T),\n              list(query = intersects, params = list(\"imex\",\"reactome\"), color= \"lightgoldenrod2\",active = T),\n              list(query = intersects, params = list(\"imex\",\"tm_epmc\"), color= \"lightgoldenrod2\",active = T)),\n      intersections = list(\n              list(\"reactome\",\"iid_pred\",\"tm_epmc\"),\n              list(\"iid_pred\",\"tm_epmc\"),\n              list(\"reactome\",\"iid_pred\"),\n              list(\"reactome\",\"tm_epmc\"),\n              list(\"imex\",\"iid_pred\",\"reactome\",\"tm_epmc\"),\n              list(\"imex\",\"reactome\",\"tm_epmc\"),\n              list(\"imex\",\"iid_pred\",\"tm_epmc\"),\n              list(\"imex\",\"iid_pred\",\"reactome\"),\n              list(\"imex\",\"iid_pred\"),\n              list(\"imex\",\"reactome\"),\n              list(\"imex\",\"tm_epmc\")))\n```\n\n### Part 3: Generating comparison dataset at the publication level\n\n```{r}\nallpub_df <- list(imex_pmids,reactome_pmids,tm_pmids)\n\npubcomp_table <- Reduce(function(...) merge(..., all=TRUE), allpub_df)\n\n# I clean and replace all NAs if present.\n\npubcomp_table_final <- pubcomp_table\npubcomp_table_final[is.na(pubcomp_table_final <- pubcomp_table)] <- 0\nwrite.table(pubcomp_table_final,\"./results/pubcomp_table_final.txt\",col.names=T,row.names=F,sep=\"\\t\",quote=F)\nsystem(\"gzip ./results/pubcomp_table_final.txt\")\n```\n\nThe comparison set gives a total number of `r nrow(pubcomp_table_final)` publications, of which `r nrow(pubcomp_table_final[pubcomp_table_final$imex==0,])` (`r round(nrow(pubcomp_table_final[pubcomp_table_final$imex==0,])*100/nrow(pubcomp_table_final),2)`%) are not curated in IMEx. \n\nI produce a plot with the summary of the overlap between the different datasets evaluated. \n\n##### Figure 3: Comparison between different protein association datasets at the publication level\n```{r echo=FALSE, fig.width=10,fig.height=6}\nupset(pubcomp_table_final, \n      nsets = 3, \n      point.size = 6, \n      name.size = 12, \n      line.size = 2, \n      mainbar.y.label = \"Common publications\", \n      sets.x.label = \"Nr of publications in dataset\", \n      order.by=\"freq\",\n      decreasing=FALSE,\n      queries = list(\n              list(query = intersects, params = list(\"reactome\",\"tm_epmc\"), color = \"blue\", active = T),\n              list(query = intersects, params = list(\"imex\",\"reactome\",\"tm_epmc\"), color= \"darkorange2\",active = T),\n              list(query = intersects, params = list(\"imex\",\"reactome\"), color= \"lightgoldenrod2\",active = T),\n              list(query = intersects, params = list(\"imex\",\"tm_epmc\"), color= \"lightgoldenrod2\",active = T),\n              list(query = intersects, params = list(\"imex\"), color= \"gray70\",active = T),\n              list(query = intersects, params = list(\"reactome\"), color= \"gray70\",active = T),\n              list(query = intersects, params = list(\"tm_epmc\"), color= \"gray70\",active = T)))\n```\n\nAnd again, I zoom in to check only the intersections.\n\n##### Figure 4: Intersection between different protein association datasets at the publication level\n```{r echo=FALSE, fig.width=10,fig.height=6}\nupset(pubcomp_table_final, \n      nsets = 3, \n      point.size = 6, \n      name.size = 12, \n      line.size = 2, \n      mainbar.y.label = \"Common protein pairs\", \n      sets.x.label = \"Nr of protein pairs in dataset\",\n      order.by=\"freq\",\n      decreasing=FALSE,\n      queries = list(\n              list(query = intersects, params = list(\"reactome\",\"tm_epmc\"), color = \"blue\", active = T),\n              list(query = intersects, params = list(\"imex\",\"reactome\",\"tm_epmc\"), color= \"darkorange2\",active = T),\n              list(query = intersects, params = list(\"imex\",\"reactome\"), color= \"lightgoldenrod2\",active = T),\n              list(query = intersects, params = list(\"imex\",\"tm_epmc\"), color= \"lightgoldenrod2\",active = T)),\n      intersections = list(\n              list(\"reactome\",\"tm_epmc\"),\n              list(\"imex\",\"reactome\",\"tm_epmc\"),\n              list(\"imex\",\"reactome\"),\n              list(\"imex\",\"tm_epmc\")))\n```\n\n********************************************************************************************\n\n### Appendix\n\n#### Code for the figures\n\n##### Figure 1: Intersection between different protein association datasets\n```{r eval=FALSE}\nlibrary(UpSetR)\nupset(comp_table_final, \n      nsets = 4, \n      point.size = 6, \n      name.size = 12, \n      line.size = 2, \n      mainbar.y.label = \"Common protein pairs\", \n      sets.x.label = \"Nr of protein pairs in dataset\", \n      order.by=\"freq\",\n      decreasing=FALSE,\n      queries = list(\n              list(query = intersects, params = list(\"reactome\",\"iid_pred\",\"tm_epmc\"), color = \"blue\", active = T),\n              list(query = intersects, params = list(\"iid_pred\",\"tm_epmc\"), color= \"cornflowerblue\",active = T),\n              list(query = intersects, params = list(\"reactome\",\"iid_pred\"), color= \"cornflowerblue\",active = T),\n              list(query = intersects, params = list(\"reactome\",\"tm_epmc\"), color= \"cornflowerblue\",active = T),\n              list(query = intersects, params = list(\"imex\",\"iid_pred\",\"reactome\",\"tm_epmc\"), color= \"darkorange2\",active = T),\n              list(query = intersects, params = list(\"imex\",\"reactome\",\"tm_epmc\"), color= \"orange1\",active = T),\n              list(query = intersects, params = list(\"imex\",\"iid_pred\",\"tm_epmc\"), color= \"orange1\",active = T),\n              list(query = intersects, params = list(\"imex\",\"iid_pred\",\"reactome\"), color= \"orange1\",active = T),\n              list(query = intersects, params = list(\"imex\",\"iid_pred\"), color= \"lightgoldenrod1\",active = T),\n              list(query = intersects, params = list(\"imex\",\"reactome\"), color= \"lightgoldenrod1\",active = T),\n              list(query = intersects, params = list(\"imex\",\"tm_epmc\"), color= \"lightgoldenrod1\",active = T),\n              list(query = intersects, params = list(\"imex\"), color= \"gray70\",active = T),\n              list(query = intersects, params = list(\"reactome\"), color= \"gray70\",active = T),\n              list(query = intersects, params = list(\"iid_pred\"), color= \"gray70\",active = T),\n              list(query = intersects, params = list(\"tm_epmc\"), color= \"gray70\",active = T)))\n\n```\n##### Figure 2: Intersection between different protein association datasets (intersections only)\n```{r eval=FALSE}\nupset(comp_table_final, \n      nsets = 4, \n      point.size = 6, \n      name.size = 12, \n      line.size = 2, \n      mainbar.y.label = \"Common protein pairs\", \n      sets.x.label = \"Nr of protein pairs in dataset\",\n      order.by=\"freq\",\n      decreasing=FALSE,\n      queries = list(\n              list(query = intersects, params = list(\"reactome\",\"iid_pred\",\"tm_epmc\"), color = \"blue\", active = T),\n              list(query = intersects, params = list(\"iid_pred\",\"tm_epmc\"), color= \"cornflowerblue\",active = T),\n              list(query = intersects, params = list(\"reactome\",\"iid_pred\"), color= \"cornflowerblue\",active = T),\n              list(query = intersects, params = list(\"reactome\",\"tm_epmc\"), color= \"cornflowerblue\",active = T),\n              list(query = intersects, params = list(\"imex\",\"iid_pred\",\"reactome\",\"tm_epmc\"), color= \"darkorange2\",active = T),\n              list(query = intersects, params = list(\"imex\",\"reactome\",\"tm_epmc\"), color= \"orange1\",active = T),\n              list(query = intersects, params = list(\"imex\",\"iid_pred\",\"tm_epmc\"), color= \"orange1\",active = T),\n              list(query = intersects, params = list(\"imex\",\"iid_pred\",\"reactome\"), color= \"orange1\",active = T),\n              list(query = intersects, params = list(\"imex\",\"iid_pred\"), color= \"lightgoldenrod1\",active = T),\n              list(query = intersects, params = list(\"imex\",\"reactome\"), color= \"lightgoldenrod1\",active = T),\n              list(query = intersects, params = list(\"imex\",\"tm_epmc\"), color= \"lightgoldenrod1\",active = T)),\n      intersections = list(\n              list(\"reactome\",\"iid_pred\",\"tm_epmc\"),\n              list(\"iid_pred\",\"tm_epmc\"),\n              list(\"reactome\",\"iid_pred\"),\n              list(\"reactome\",\"tm_epmc\"),\n              list(\"imex\",\"iid_pred\",\"reactome\",\"tm_epmc\"),\n              list(\"imex\",\"reactome\",\"tm_epmc\"),\n              list(\"imex\",\"iid_pred\",\"tm_epmc\"),\n              list(\"imex\",\"iid_pred\",\"reactome\"),\n              list(\"imex\",\"iid_pred\"),\n              list(\"imex\",\"reactome\"),\n              list(\"imex\",\"tm_epmc\")))\n```\n##### Figure 3: Comparison between different protein association datasets at the publication level\n```{r eval=FALSE}\nupset(pubcomp_table_final, \n      nsets = 4, \n      point.size = 6, \n      name.size = 12, \n      line.size = 2, \n      mainbar.y.label = \"Common publications\", \n      sets.x.label = \"Nr of publications in dataset\", \n      order.by=\"freq\",\n      decreasing=FALSE,\n      queries = list(\n              list(query = intersects, params = list(\"reactome\",\"tm_epmc\"), color = \"blue\", active = T),\n              list(query = intersects, params = list(\"imex\",\"reactome\",\"tm_epmc\"), color= \"darkorange2\",active = T),\n              list(query = intersects, params = list(\"imex\",\"reactome\"), color= \"lightgoldenrod2\",active = T),\n              list(query = intersects, params = list(\"imex\",\"tm_epmc\"), color= \"lightgoldenrod2\",active = T),\n              list(query = intersects, params = list(\"imex\"), color= \"gray70\",active = T),\n              list(query = intersects, params = list(\"reactome\"), color= \"gray70\",active = T),\n              list(query = intersects, params = list(\"tm_epmc\"), color= \"gray70\",active = T)))\n```\n##### Figure 4: Intersection between different protein association datasets at the publication level\n```{r eval=FALSE}\nupset(pubcomp_table_final, \n      nsets = 3, \n      point.size = 6, \n      name.size = 12, \n      line.size = 2, \n      mainbar.y.label = \"Common protein pairs\", \n      sets.x.label = \"Nr of protein pairs in dataset\",\n      order.by=\"freq\",\n      decreasing=FALSE,\n      queries = list(\n              list(query = intersects, params = list(\"reactome\",\"tm_epmc\"), color = \"blue\", active = T),\n              list(query = intersects, params = list(\"imex\",\"reactome\",\"tm_epmc\"), color= \"darkorange2\",active = T),\n              list(query = intersects, params = list(\"imex\",\"reactome\"), color= \"lightgoldenrod2\",active = T),\n              list(query = intersects, params = list(\"imex\",\"tm_epmc\"), color= \"lightgoldenrod2\",active = T)),\n      intersections = list(\n              list(\"reactome\",\"tm_epmc\"),\n              list(\"imex\",\"reactome\",\"tm_epmc\"),\n              list(\"imex\",\"reactome\"),\n              list(\"imex\",\"tm_epmc\")))\n```",
    "created" : 1460451535646.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2305515056",
    "id" : "35667AA0",
    "lastKnownWriteTime" : 1460652020,
    "path" : "~/Documents/Projects/darkspaceproject/dsp_comparison/dsp_comparison.Rmd",
    "project_path" : "dsp_comparison.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}