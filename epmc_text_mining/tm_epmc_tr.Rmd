---
title: Extracting text mining predictions EPMC
date: 2016-12-15
author: Pablo Porras
---
```{r set-options, echo=FALSE}
options(width = 80)
```
Text mining prediction EPMC: Technical report
========================================================

### Synopsis

We collaborated the EPMC team at EBI to use text-mining techniques that use a set of keywords (see Appendix) that describe potential interaction relationships to identify sentences that may depict interacting proteins. The sentences are extracted from the abstract or full text (when available, due to copyright restrictions) or publications listed in PubMed. The text-mining exercise was performed by Senay Kafkas (SK). Email exchange about this subject can be found in the folder ./source_files/emails. A new version of the files was sent on November 2016 and two files provided by SK were merged in a single file for further processing. 

This slimmed version fo the report only includes the steps required to obtain the text-mining pairs from the new files sent by SK. 

#### Evaluate and extract information from SK file

SK sent the result file from her search script on 2015/08/28 and an updated version with all PMIDs added on 2016/04/07. Here is the text of the email she sent on the first instance:  

*"I now adapted our gene-disease pipeline which we developed for the cttv project, for extracting the PPIs. I used the keyword list that we agreed on before.*  

*The data that I generated is big, hence I cannot attach it to the e-mail, but you can access it from:*

*/nfs/misc/literature/shenay/PPIExtraction/PPIData4Expr.txt*

*I provided the data in the format that we provide for the cttv project. The first line in the file describes the data format which is not complicated to understand. One thing is I provided only 3 publication IDs and sentences. However if you would need all of the publications and sentences, I can extract this data easily as well."*

It is important to note that the data contains human identifiers only. 

UPDATE: SK sends an updated version of the files, divided by results found mining full text or only abstracts. 

*You can find the latest PPI data here:*

*abstracts:*
*/nfs/misc/literature/shenay/PPIExtraction/PPI.Medline.Nov16.txt*

*full text:*
*/nfs/misc/literature/shenay/PPIExtraction/PPI.OA.Nov16.txt*

This the file format structure, as described by SK:

  1. PMC ID
  2. pubmed id*
  3. publication date*
  4. interacting protein pair, separated by ||
  5. all the supporting sentences for that specific pair extracted from that specific article, separated by ||||
  6. section information where those sentences is coming from, separated by ||||
  7. the interacting pairs extracted from those sentences (proteins are separated by ||), pairs are separated by ||||
  8. Offsets of those proteins separated by |||| (e.g. 19_21##196_200||||........)  here 19_21 is the start and end index of the first protein in the sentence and 196_200  is the offset of its interacting protein. rest is ignorable, these are the counts and scores generated by the pipeline for the confidence calculation. You probably no need them. 

A new file is created appending both files sent by SK using the 'cat' shell command (*cat file1 >> file2*). 

#### Uploading the text-mined dataset

I upload only the fields I need, so the file size does not get out of hand. 

```{r, tm_upload, message=F, warning=F, cache=TRUE}
require(data.table)

setwd("./source_files/")
system("tar xf PPI_tm_Nov16.txt.tar.gz")
# I need to clean up several undesired line breaks in the file
system("perl -i -pe 's/Mauviel et\n/Mauviel et/' PPI_tm_Nov16.txt")
system("perl -i -pe 's/According to Bia et\n/According to Bia et/' PPI_tm_Nov16.txt")
system("perl -i -pe 's/Lichty et\n/Lichty et/' PPI_tm_Nov16.txt")
tm_sel <- fread("PPI_tm_Nov16.txt", sep = "\t", header = F, colClasses=c("character","character","character","character","NULL","character","character","NULL","NULL","NULL","NULL","NULL","NULL","NULL","NULL","NULL","NULL","NULL","NULL","NULL","NULL","NULL","NULL"),data.table = F)
system("rm PPI_tm_Nov16.txt")
setwd("../")

colnames(tm_sel) <- c("pmcid","pmid","date","upacs","location","symbols")
```

#### Extract protein and pair information

I need to extract the upacs and deal withg the redundant ones. 
```{r format_data,cache=T,message=FALSE}
tm_sel$upac_1 <- gsub("\\|\\|.*","",tm_sel$upacs)
tm_sel$upac_2 <- gsub(".*\\|\\|","",tm_sel$upacs)

library(splitstackshape)
tm_long_pt1 <- cSplit(tm_sel, "upac_1", sep = ",", direction = "long")
tm_long <- cSplit(tm_long_pt1, "upac_2", sep = ",", direction = "long")

tm_long$upac_1 <- as.character(tm_long$upac_1)
tm_long$upac_2 <- as.character(tm_long$upac_2)
```

Now I generate the pair ids for the text-mined datset.

```{r,cache=T,message=FALSE}
library(dplyr)
tm_long$pair_id <- apply(select(tm_long,upac_1,upac_2), 1,function(i){
  paste(sort(i),collapse = "_")
})
tm_long$tm <- 1
```

#### Generating comparison file

```{r}
tm_lite <- unique(select(tm_long,pair_id,pmid,tm))
write.table(tm_lite,"./results/pairs_pmids_tm.txt",col.names=T,row.names=F,quote=F,sep="\t")
system("gzip ./results/pairs_pmids_tm.txt")
```

************************************************************

## Appendix: Keywords describing interaction relationships

 - (de)acetylate
 - (co)activate
 - transactivate 
 - (dis)associate 
 - add ?
 - bind
 - link ?
 - catalyse
 - cleave
 - co(-)immunoprecipitate, co(-)ip
 - (de)methylate
 - (de)phosphorylate
 - (de)phosphorylase
 - produce ?
 - modify
 - impair 
 - inactivate 
 - inhibit 
 - interact
 - react
 - (dis)assemble
 - discharge ?
 - modulate 
 - stimulate
 - substitute ?
 - (de)ubiquitinate 
 - heterodimerize
 - heterotrimerize 
 - immunoprecipitate
 - (co)assemble
 - co-crystal
 - complex
 - copurifies
 - cross-link
 - two(-)hybrid, 2(-)hybrid, 2(-)H, yeast two(-) hybrid, yeast 2(-) hybrid), Y(-)2H, classical two(-)hybrid, classical 2(-) hybrid, Gal4 transcription regeneration
 - cosediment
 - comigrate
 - AP(-)MS
 - TAP-MS
 - Homo (dimer/trimer/tetramerâ€¦)
 - Oligomerize

********************************************************
